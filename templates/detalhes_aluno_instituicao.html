{% extends 'base.html' %}
{% set hide_navbar = False %}

{% block title %}Detalhes do Aluno - Instituição{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1 class="text-center mb-4">Detalhes do Aluno</h1>

    <form method="POST">
        <div class="mb-3">
            <label for="nome_jovem" class="form-label">Nome</label>
            <input type="text" class="form-control" id="nome_jovem" name="nome_jovem" value="{{ aluno.nome_jovem }}" required>
        </div>
        <div class="mb-3">
            <label for="data_nascimento" class="form-label">Data de Nascimento</label>
            <input type="date" class="form-control" id="data_nascimento" name="data_nascimento" value="{{ aluno.data_nascimento }}">
        </div>
        <div class="mb-3">
            <label for="contato_jovem" class="form-label">Contato</label>
            <input type="text" class="form-control" id="contato_jovem" name="contato_jovem" value="{{ aluno.contato_jovem }}">
        </div>
        <div class="mb-3">
            <label for="email" class="form-label">E-mail</label>
            <input type="email" class="form-control" id="email" name="email" value="{{ aluno.email }}" required>
        </div>
        <div class="mb-3">
            <label for="endereco_jovem" class="form-label">Endereço</label>
            <input type="text" class="form-control" id="endereco_jovem" name="endereco_jovem" value="{{ aluno.endereco_jovem }}">
        </div>
        <div class="mb-3">
            <label for="curso" class="form-label">Curso</label>
            <input type="text" class="form-control" id="curso" name="curso" value="{{ aluno.curso }}">
        </div>
        <div class="mb-3">
            <label for="formacao" class="form-label">Formação</label>
            <input type="text" class="form-control" id="formacao" name="formacao" value="{{ aluno.formacao }}">
        </div>
        <div class="mb-3">
            <label for="periodo" class="form-label">Período</label>
            <input type="number" class="form-control" id="periodo" name="periodo" value="{{ aluno.periodo }}">
        </div>

        <h4 class="mt-4">Skills</h4>
        <h4 class="mt-4">Hard Skills</h4>
        <div class="row">
            {% for label in hard_labels %}
            <div class="col-md-6">
                <label>{{ label }}</label>
                <input type="number" class="form-control" name="hard_{{ label.lower().replace(' ', '_') }}"
                    value="{{ hard_dict[label] if hard_dict[label] is defined else 0 }}" min="0" max="10" step="1" required>
            </div>
            {% endfor %}
        </div>

        <h4 class="mt-4">Soft Skills</h4>
        <div class="row">
            {% for label in soft_labels %}
            <div class="col-md-6">
                <label>{{ label }}</label>
                <input type="number" class="form-control" name="{{ label.lower().replace(' ', '_') }}"
                    value="{{ soft_dict[label] if soft_dict[label] is defined else 0 }}" min="0" max="10" step="1" required>
            </div>
            {% endfor %}
        </div>

        <button type="submit" class="btn btn-primary mt-4">Salvar Alterações</button>
    </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Seleciona todos os inputs de skills
    const skillInputs = document.querySelectorAll(
        '#hard_skills, #soft_skills, #avaliacao_geral, #participacao, #comunicacao, #proatividade, #raciocinio, #dominio_tecnico, #criatividade, #trabalho_em_equipe'
    );
    skillInputs.forEach(function(input) {
        input.addEventListener('keydown', function(e) {
            // Permite teclas de controle
            if (
                e.key === "Backspace" || e.key === "Tab" || e.key === "Delete" ||
                e.key === "ArrowLeft" || e.key === "ArrowRight" || e.key === "Home" || e.key === "End"
            ) {
                return;
            }
            // Permite apenas números de 0 a 9
            if (!/^[0-9]$/.test(e.key)) {
                e.preventDefault();
            }
            // Impede digitar mais de dois dígitos
            if (this.value.length >= 2 && this.selectionStart === this.selectionEnd) {
                e.preventDefault();
            }
        });
        input.addEventListener('input', function() {
            let value = this.value.replace(/[^0-9]/g, '');
            if (value.length > 2) value = value.slice(0, 2);
            if (parseInt(value) > 10) value = '10';
            this.value = value;
        });
    });
});
</script>
{% endblock %}